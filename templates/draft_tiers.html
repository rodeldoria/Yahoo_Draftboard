<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fantasy Champs - Player Tiers</title>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .banner {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
        }

        .form-inline {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px;
        }

        .compact-input {
            padding: 5px;
            font-size: 14px;
            border: 1px solid #444;
            border-radius: 5px;
            background-color: #333;
            color: #fff;
        }

        .compact-button {
            padding: 5px 10px;
            font-size: 14px;
            border: 1px solid #444;
            border-radius: 5px;
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
        }

        .compact-button:hover {
            background-color: #555;
        }

        .tier-list {
            margin: 20px;
        }

        .highlight-light-green {
            background-color: lightgreen;
        }

        .highlight-light-gold {
            background-color: gold;
        }

        .highlight-light-red {
            background-color: lightcoral;
        }

        .highlight-light-purple {
            background-color: plum;
        }
    </style>
</head>

<body>
    <div class="banner">Fantasy Champs - Player Tiers</div>
    <div class="form-inline">
        <form id="uploadForm" enctype="multipart/form-data">
            <input type="file" name="file" id="fileInput" accept=".pdf" class="compact-input">
            <input type="submit" value="Upload" class="compact-button">
        </form>
    </div>

    <div id="tier-list" class="tier-list"></div>

    <script>
        // Event listener for the upload form submission
        document.getElementById('uploadForm').addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent default form submission
            const formData = new FormData(this); // Create FormData object from the form
            fetch('/upload', {
                method: 'POST',
                body: formData // Send form data to the server
            })
                .then(response => response.json())
                .then(data => {
                    console.log('Uploaded data:', data); // Log uploaded data
                    displayTierList(data); // Display the tier list
                })
                .catch(error => console.error('Error uploading file:', error)); // Handle errors
        });

        // Function to display the tier list based on uploaded data
        function displayTierList(data) {
            const tierListDiv = document.getElementById('tier-list');
            tierListDiv.innerHTML = ''; // Clear existing data

            const positions = ["QB", "WR", "RB", "TE", "K", "DEF"]; // Define player positions
            positions.forEach(position => {
                if (data[position] && data[position].length > 0) {
                    const positionDiv = document.createElement('div');
                    positionDiv.innerHTML = `<h2>${position}</h2>`; // Set position title

                    const table = document.createElement('table');
                    table.style.borderCollapse = 'collapse';
                    table.innerHTML = `
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Name</th>
                                <th>Team</th>
                                <th>ADP</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="${position}-tbody">
                        </tbody>
                    `;

                    data[position].forEach(player => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${player.Rank}</td>
                            <td class="player-name">${player.Name}</td>
                            <td>${player.Team}</td>
                            <td>${player.ADP}</td>
                            <td>
                                <span class="material-symbols-outlined" onclick="highlightCell(this, 'light-green')">check_circle</span>
                                <span class="material-symbols-outlined" onclick="highlightCell(this, 'light-gold')">star</span>
                                <span class="material-symbols-outlined" onclick="highlightCell(this, 'light-red')">close</span>
                                <span class="material-symbols-outlined" onclick="highlightCell(this, 'light-purple')">lock</span>
                            </td>
                        `;
                        table.querySelector('tbody').appendChild(row); // Append player row to table
                    });

                    positionDiv.appendChild(table); // Add table to position group
                    tierListDiv.appendChild(positionDiv); // Add position group to tier list
                }
            });
        }

        // Function to highlight a cell based on the selected color
        function highlightCell(icon, color) {
            const row = icon.closest('tr'); // Get the closest row
            row.classList.remove('highlight-light-green', 'highlight-light-gold', 'highlight-light-red', 'highlight-light-purple'); // Remove existing highlights
            switch (color) {
                case 'light-green':
                    row.classList.add('highlight-light-green'); // Add light green highlight
                    break;
                case 'light-gold':
                    row.classList.add('highlight-light-gold'); // Add light gold highlight
                    break;
                case 'light-red':
                    row.classList.add('highlight-light-red'); // Add light red highlight
                    break;
                case 'light-purple':
                    row.classList.add('highlight-light-purple'); // Add light purple highlight
                    break;
            }
        }
    </script>
</body>

</html>